---
import { getEntryBySlug } from 'astro:content'
import Layout from '@layouts/Layout.astro'
import { getProducts } from '@utils/shopify'
import Blocks from '@components/helpers/Blocks.astro'
import ProductGrid from '@components/ProductGrid.svelte'

const page = await getEntryBySlug('pages', 'producten')

const products = await getProducts()
const mappedProducts = products.map((prod) => {
  return {
    heading: prod.title,
    textarea: prod.description,
    image: {
      src: prod.images[0]?.src,
      alt: prod.images[0]?.altText,
    },
    price: products[0].variants[0].priceV2.amount,
    href: `/producten/${prod.handle}`,
  }
})
---

<Layout seo={null}>
  <Blocks
    pageData={page.data}
    keys={['hero']}
  />
  <ProductGrid products={mappedProducts} />
</Layout>
